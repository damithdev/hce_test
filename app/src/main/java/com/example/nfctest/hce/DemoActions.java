package com.example.nfctest.hce;

import android.util.Log;

import com.example.nfctest.hce.util.ByteUtil;

import java.io.InputStream;
import java.security.Key;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.NoSuchAlgorithmException;

public class DemoActions {
    public void generateICCKeyPair(){
        try {
            KeyPairGenerator kpg = KeyPairGenerator.getInstance("RSA");
            kpg.initialize(1408);
            KeyPair kp = kpg.generateKeyPair();
            Key pub = kp.getPublic();
            Key pvt = kp.getPrivate();

            Log.d("Public Key:", ByteUtil.bytes2HexStr(pub.getEncoded()));
            Log.d("Private Key:",ByteUtil.bytes2HexStr(pvt.getEncoded()));
        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
        }
    }

    public void GenerateICCCert(){
        String IssPvtK = "3571113835000101B001A5573DFE0A2B7BBCD5C249FBA9B6D963DC35F66887C3C22B6173754F10E66162ADA37DD56A03D4B05205B797A1066FCB31BA89EE08BB9D21A0E2B521FED2A1844DB803040CAFAEE6B555625E7076EC37ADD6208CCEA0B4DE77899EFF2B862698DFAFA112F87038609D77DD68BFE6C163A60E9F900E8AC53525196B2BF951EC86884340831E8CA56C46F6048E1E0EA7834A6D2971DECB3B3015B2987FD043A0D2A0CAEC87D70E7836476504ECB5AB239B030039EB754ED07E570F20C2569B4CAA3C4D8C7E7676B554C7066906980C9115A419DB40D57760CCDD8FAD8FCD2031A4F75B50586216B67D2740C9F80100A0B9FE2584A661DB68F2C4E934F3E01A8E3C4F1C59A389EEF4D2CA1625FC391ACF87056050E7E053F031B7B00999B19C689DA8F9A3789A4DF6E6CE4AA509E250532C34576AD37D2C0547ACDBBD973E2D4282B60B6CCB8F903B82EA17A1B7659300A202C550B32244025BAA198A703D1162EDB7";
        String ICCPubK = "3081CF300D06092A864886F70D01010105000381BD003081B90281B100C7D73D363E8EC123749F1471A46234489A832F512DAF778CFCEDAF09F8EE169B08A2434BF07ADB509098B6898E1E1497C97FA85D98073F8052926E574C1E8A86EBA2AF9A68106B44F68F5D6FC5B832CB7D69DCE2BE118504261A38EAD47DFE8A6939A9068F9220DF405C49D02B5310D2A4E437E7A32BC000DB45F5F69BF23A4D333F6ED62B815B7D1821E603C89A6702BF9B684A3B621B0C3DBC31AB746E27C9BAC1FABC2DD3F20C008359B86C2A12630203010001";
        String ICCPvtK = "3082034F020100300D06092A864886F70D010101050004820339308203350201000281B100C7D73D363E8EC123749F1471A46234489A832F512DAF778CFCEDAF09F8EE169B08A2434BF07ADB509098B6898E1E1497C97FA85D98073F8052926E574C1E8A86EBA2AF9A68106B44F68F5D6FC5B832CB7D69DCE2BE118504261A38EAD47DFE8A6939A9068F9220DF405C49D02B5310D2A4E437E7A32BC000DB45F5F69BF23A4D333F6ED62B815B7D1821E603C89A6702BF9B684A3B621B0C3DBC31AB746E27C9BAC1FABC2DD3F20C008359B86C2A126302030100010281B0252ED542DC8CEF3ECB9A35D197467677F3D7E8DBEFE63016599157FA4108FBC7C8E978200F14ACEDE699A38D2096543A91D160E059432FFB8E61948A45AD8114ED8F0DA16B2F72E6180240DE65298AB9F611D67991E7EC99AED4AE3D6654CDB8E4DA5C05BE9ABCB1B83F5E0A244F970AA7ACCD2533F1A64276F1B72B0D0BC31B10733B48A536E7369FD12C07BF181D14F65681EB3F0ACA17DB5D75BA018DA3A0430112EC9778C03A3D48225BE4C69101025900E71B507FD737F3A8C23E40968A2695ED79A86C2CE37AEDD8127CCD30E6D962E4D5462875F415525F2AE3CAB443988141CF2A9F2C33FAD8AB82322703D5FB47A1F1AA20BC8C2DF38FA90CF147E9BFA1E0BDAFD13846357C41025900DD5DC7296F2EB2359DAD2A8B9812D64D9578522A18A7D27BA0A636A615E7EB9267684424E861959DC2DCA2295E88E6B63EEF62DEE7A2DE8E9791FA52172D7253621628752854EBD782AB2119B096FC57260E88A03EC2B5A302590088CB5A32D1A984C8777171B9A9BC7D323BB8BD8F34772721A68FC8C5115FCB71B7EBF7371A6B247EC05C65379E6B3ED73D50F536ACEDE6225EC660E19C5F485F4B34707C2A5D68B5B852B8DEE03556143933409C16B2C20102590090F48EAD483BF8C0793EE2C44451D979366E72C7541BD90DD175E6053E04FF52805A5B7D1B9A8321AA6F55D4E72D987E309A0B5151B76A2B4F7F6CBE82A4E4DF4B349D4B929C814F3F2696673F26AF98D5B7E0A9A64F5427025828531919CEBE592B5E37B88652E85CDFC76FF8F2DF79F226BDEF354A24F3DC2336DA64EA06C2CE39A8B85D3F7EACE16053FB4B4D6E9BCD835EED1C8FC6761CDDC52F7936A88E50632B56DF35A4D66157D8C726BD1D694943";

        String certificateFormat;
        String ApplicationPAN;
        String CertificateExpDate;
        String CertificateSerialNo;
        String HashAlgorithmIndicator;
        String ICCPublicKeyAlgorithmIndicator;
        String ICCPublicKeyLength;
        String ICCPublicKeyExponentLength;
        String ICCPublicKeyOrLeftmostDigitsOfTheIccPublicKey;
        String ICCPublicKeyRemainder;
        String ICCPublicKeyExponent;

        //Static Data to be authenticated;
        String RegisterdApplicationProviderIdentifier;
        String CertificationAuthorityPublicKeyIndex;
        String IssuerPublicKeyCertificate;
        String IssuerPublicKeyRemainder;
        String IssuerPublicKeyExponent;
        String ICCPublicKeyCertificate;
        ICCPublicKeyRemainder = "";
        ICCPublicKeyExponent ="";
    }
}
